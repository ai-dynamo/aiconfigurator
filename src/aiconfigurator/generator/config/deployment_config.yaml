# SPDX-FileCopyrightText: Copyright (c) 2025-2026 NVIDIA CORPORATION & AFFILIATES. All rights reserved.
# SPDX-License-Identifier: Apache-2.0

inputs:
  # Optional per-backend controls:
  # - "backends": restricts an entry to the listed backend names.
  # - "backend_defaults": overrides "default" per backend (e.g. trtllm, vllm, sglang).
  # SlaConfig
  - key: SlaConfig.isl
    required: false
  - key: SlaConfig.osl
    required: false

  # ServiceConfig
  - key: ServiceConfig.model_path
    required: true
    default: ""
  - key: ServiceConfig.hf_token
    required: false
    default: ""
  - key: ServiceConfig.served_model_name
    required: true
    default: "ServiceConfig.model_name or ServiceConfig.served_model_path or ServiceConfig.model_path"
  - key: ServiceConfig.model_name
    required: false
    default: "ServiceConfig.served_model_name"
  - key: ServiceConfig.head_node_ip
    required: false
    default: "0.0.0.0"
  - key: ServiceConfig.port
    required: false
    default: 8000
  - key: ServiceConfig.include_frontend
    required: false
    default: true
  - key: ServiceConfig.dyn_vllm_kv_event_port
    required: false
    default: 20081
    backends: ["vllm"]
  - key: ServiceConfig.vllm_nixl_side_channel_port
    required: false
    default: 20097
    backends: ["vllm"]

  # DynConfig
  - key: DynConfig.mode
    required: false
    default: "disagg"
  - key: DynConfig.enable_router
    required: false
    default: false

  # K8sConfig
  - key: K8sConfig.name_prefix
    required: false
    default: "dynamo"
  - key: K8sConfig.k8s_namespace
    required: false
    default: "dynamo"
  - key: K8sConfig.k8s_image
    required: false
    default: &default_trtllm_image "nvcr.io/nvidia/ai-dynamo/tensorrtllm-runtime:0.8.0"
    backend_defaults:
      trtllm: *default_trtllm_image
      vllm: "nvcr.io/nvidia/ai-dynamo/vllm-runtime:0.8.0"
      sglang: "nvcr.io/nvidia/ai-dynamo/sglang-runtime:0.8.0"
  - key: K8sConfig.k8s_image_pull_secret
    required: false
    default: ""
  - key: K8sConfig.k8s_engine_mode
    required: false
    default: "inline"
    backends: ["trtllm"]
  - key: K8sConfig.k8s_model_cache
    required: false
    default: ""
  - key: K8sConfig.k8s_hf_home
    required: false
    default: ""

  # Worker config
  - key: WorkerConfig.prefill_workers
    required: false
    default: 1
  - key: WorkerConfig.decode_workers
    required: false
    default: 1
  - key: WorkerConfig.agg_workers
    required: false
    default: 1

  # Runtime additions
  - key: ModelConfig.is_moe
    required: false
    default: false
  - key: ModelConfig.nextn
    required: false
    default: 0
  - key: ModelConfig.prefix
    required: false
    default: 0

  # NodeConfig
  - key: NodeConfig.num_gpus_per_node
    required: false
    default: 8

  # BenchConfig
  - key: BenchConfig.name
    required: false
    default: "('dynamo-' ~ DynConfig.mode ~ '-benchmark')"
  - key: BenchConfig.image
    required: false
    default: "python:3.12-slim"
  - key: BenchConfig.profile_start_timeout
    required: false
    default: 400
  - key: BenchConfig.endpoint_type
    required: false
    default: "'chat'"
  - key: BenchConfig.endpoint_url
    required: false
    default: "('http://dynamo-' ~ DynConfig.mode ~ '-frontend.' ~ K8sConfig.k8s_namespace ~ '.svc.cluster.local:8000')"
  - key: BenchConfig.model
    required: false
    default: "ServiceConfig.served_model_name or ServiceConfig.model_name or ServiceConfig.served_model_path or ServiceConfig.model_path"
  - key: BenchConfig.tokenizer
    required: false
    default: "ServiceConfig.model_path or ServiceConfig.served_model_path or BenchConfig.model"
  - key: BenchConfig.isl
    required: false
    default: "SlaConfig.isl"
  - key: BenchConfig.osl
    required: false
    default: "SlaConfig.osl"
  - key: BenchConfig.isl_stddev
    required: false
    default: 0
  - key: BenchConfig.osl_stddev
    required: false
    default: 0
  - key: BenchConfig.concurrency
    required: false
    default: "[1, 2, 4, 8, 32, 64, 128, 256]"
  - key: BenchConfig.estimated_concurrency
    required: false
  - key: BenchConfig.num_requests
    required: false
    default: "BenchConfig.concurrency | map('multiply', 50) | list"
  - key: BenchConfig.ui
    required: false
    default: "'simple'"